# 社会化聆听
基于互联网公开数据，分析和监控媒体声音，实现企业口碑监控、企业影响力分析、竞争品牌分析等社会化聆听核心业务场景，辅助进行品牌宣传、危机公关等事件的决策。


## 场景描述
基于采集的互联网新闻数据，利用文本聚类算法、文本情感分析算法等自然语言处理技术发现热点事件，分析热点事件情感走势，及热点事件的影响力。


## [部署包](./DeployPkg)
解决方案提供了可部署在自有Azure订阅的解决方案部署包，通过部署解决方案，用户可以深入了解如何利用Azure云服务实现业务场景。



### 部署前提
要进行舆情洞察解决方案的部署，必须具备如下的资源和条件

 1. 具有Azure中国的[订阅账号](https://www.azure.cn/)
 2. 订阅账号中包含足够可用的资源配额和权限
     1. 能够创建资源组
     2. 能够创建SQL Azure服务器和数据库以及相关防火墙规则
     3. 能够创建服务计划（Service Plan）和网站应用（Web App）
 3. 系统安装Azure SDK及Powershell 5.0

### [部署包组成]((./DeployPkg))
部署包 socialSentiment.zip解压后主要包含以下几个部分

  1. setup.ps1 用于进行自动化部署的主要脚本。
  2. SocialSentiment 文件夹存放已经发布好的网站代码。
  3. socialSentimentdb.zip 数据库。


### 发布Web应用用于服务部署

要构建新的部署包，需要将源代码进行生成发布，作为部署包的部署内容。

  1. 打开源代码工程，选择MediaMonitoring工程，点击右键，选择**发布(Publish)**.
  2. 在弹出的页面中, 选择**自定义（Custom）**。点击下一步。
  3. 在接下来的**发布方式**（Publish Method）中选择 **文件系统**。
  4. 打开[部署包](./DeployPkg)文件夹，在该文件夹中新建文件夹**SSCN**。
  5. 在**目标位置**中新建文件夹SocialSentiment作为目标位置
  6. 点击下一步，选择**发布**版本。
  7. 点击**完成**，进行工程的生成和发布。发布完成之后可以在SocialSentiment文件夹中看到完整的网站应用结构文件。

### 部署流程

部署流程包含了在Azure订阅中进行资源创建的过程。完成的创建过程包含了以下步骤。

  1. 进行Azure订阅登录。
  2. 创建SQL Azure数据库服务器及数据库。
  3. 创建服务计划以及Web应用。
  4. 将Web应用文件使用FTP的方式上传到Web应用中。


### 部署步骤

  1. 解压DeployPkg下的项目文件包到当前目录，打开PowerShell，切换当前文件夹到DeployPkg下面。
  2. 运行setup.ps1。
  3. 在弹出的登录框中输入Azure订阅的用户名和密码，验证登录。  
  4. 根据提示，选择部署地点，输入1回车选取为China North， 2回车选取为China East。
  5. 根据提示，回车创建一个新的数据库。
  6. 根据提示，输入数据库服务器的用户名，比如azure，sa不能作为该用户名。
  7. 输入数据库服务器密码，需要最短8位，包含大小写字母，数字及特殊字符，如Passw0rd!。
  8. 等待脚本运行，直到部署完成。


脚本执行完后，如果部署成功，会返回发布成功的网站信息，DefaultHostName参数的值即是网站的地址，进入这个地址就会看到部署的方案。在发布成功的网站信息中，DefaultHostName参数的值是方案所用的Azure资源组的名字。部署完成之后，可以登录到Azure Portal中，在资源组中通过'RGsocialsenti'进行筛选，找到对应的资源组进行资源相关信息查看和管理。在此资源组里可以看到本方案用到的所有资源：一个数据库服务器，一个数据库，一个存储账户，一个应用服务计划和一个应用服务。



## [源代码](./src)
解决方案提供了相应的源代码包供用户参考。用户可以通过修改源码来快速搭建及开发基于Azure的定制化的Demo。通过使用Visual Studio打开\src\MediaMonitoring.sln文件可以打开工程。

源代码主要包含以下几个工程
  1. DataAccessLayer 工程。
  2. MediaMonitoring 用于发布到Azure网站应用的工程。系统的部署也需要先将该工程进行发布，形成整体的部署包。


## 重新部署
重新部署的主要操作是删除这个方案所用的资源组以及中的所有资源。登录 https://portal.azure.cn 在“资源组”菜单下找到以‘RGsocialsenti'为开头的资源组。点击这个资源组，可以看到右侧显示区域列出该资源组下的相关资源，点击资源组右侧的“删除” 即可删除整个资源组。


